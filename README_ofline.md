# Crypto System Inventory -- local version
Zeek SSL logs and ciphersuites mapping
---
- This application primarily extracts SSL logs analyzed by Zeek from each pcap file, matches and enriches the data with cipher suites to perform an inventory of encryption systems. It automates the generation of reports as a `.xlsx` file.  
- The output includes details such as the corresponding ISP, TLS-related information, and security levels for different source IPs and the IPs they visit. Users can fine-tune the deployment methods and parameters based on their own environments. 
---

## Usage
1. Put your pcap files under the `pcap_files/` folder. (only accept `.pcap` and `.pcapng`)
2. Change the parameter in `.env` file (if needed)
3. Run the script: ```bash crypto_inventory_local.sh```
4. Go into the `crypto_inventory_report/` folder then you can see your report.

---
## Output format

| origin_ip     | origin_port | response_ip  | response_port | tls_version | isp       | country | ciphersuite_name       | ciphersuite_security | ciphersuite_attribute_hex_code | ciphersuite_attribute_tls_version | ciphersuite_crypyto_system_protocol_tag | ciphersuite_crypyto_system_protocol_method | ciphersuite_crypyto_system_protocol_weakness | ciphersuite_crypyto_system_keyxchange_tag | ciphersuite_crypyto_system_keyxchange_method | ciphersuite_crypyto_system_keyxchange_weakness | ciphersuite_crypyto_system_authentication_tag | ciphersuite_crypyto_system_authentication_method | ciphersuite_crypyto_system_authentication_weakness | ciphersuite_crypyto_system_encryption_tag | ciphersuite_crypyto_system_encryption_method                                      | ciphersuite_crypyto_system_encryption_weakness | ciphersuite_crypyto_system_hash_tag | ciphersuite_crypyto_system_hash_method                                            | ciphersuite_crypyto_system_hash_weakness | ciphersuite_reference_name | ciphersuite_reference_url                                                |
| ------------- | ----------- | ------------ | ------------- | ----------- | --------- | ------- | ---------------------- | -------------------- | ------------------------------ | --------------------------------- | --------------------------------------- | ------------------------------------------ | -------------------------------------------- | ----------------------------------------- | -------------------------------------------- | ---------------------------------------------- | --------------------------------------------- | ------------------------------------------------ | -------------------------------------------------- | ----------------------------------------- | --------------------------------------------------------------------------------- | ---------------------------------------------- | ----------------------------------- | --------------------------------------------------------------------------------- | ---------------------------------------- | -------------------------- | ------------------------------------------------------------------------ |
| 140.92.164.42 | 56779       | 61.216.83.41 | 443           | TLSv13      | HINET-NET | TW      | TLS_AES_128_GCM_SHA256 | recommended          | ['0x13', '0x01']               | ['TLS1.3']                        | null                                    | Transport Layer Security (TLS)             | null                                         | PFS                                       | ECDHE                                        | null                                           | null                                          | null                                             | null                                               | AEAD                                      | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                           | AEAD                                | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                     | RFC 8446                   | [https://ciphersuite.info/rfc/8446/](https://ciphersuite.info/rfc/8446/) |
| 140.92.164.42 | 56778       | 61.216.83.41 | 443           | TLSv13      | HINET-NET | TW      | TLS_AES_128_GCM_SHA256 | recommended          | ['0x13', '0x01']               | ['TLS1.3']                        | null                                    | Transport Layer Security (TLS)             | null                                         | PFS                                       | ECDHE                                        | null                                           | null                                          | null                                             | null                                               | AEAD                                      | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                           | AEAD                                | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                     | RFC 8446                   | [https://ciphersuite.info/rfc/8446/](https://ciphersuite.info/rfc/8446/) |
| 140.92.164.42 | 56783       | 61.216.83.41 | 443           | TLSv13      | HINET-NET | TW      | TLS_AES_128_GCM_SHA256 | recommended          | ['0x13', '0x01']               | ['TLS1.3']                        | null                                    | Transport Layer Security (TLS)             | null                                         | PFS                                       | ECDHE                                        | null                                           | null                                          | null                                             | null                                               | AEAD                                      | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                           | AEAD                                | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                     | RFC 8446                   | [https://ciphersuite.info/rfc/8446/](https://ciphersuite.info/rfc/8446/) |
| 140.92.164.42 | 56782       | 61.216.83.41 | 443           | TLSv13      | HINET-NET | TW      | TLS_AES_128_GCM_SHA256 | recommended          | ['0x13', '0x01']               | ['TLS1.3']                        | null                                    | Transport Layer Security (TLS)             | null                                         | PFS                                       | ECDHE                                        | null                                           | null                                          | null                                             | null                                               | AEAD                                      | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                           | AEAD                                | Advanced Encryption Standard with 128bit key in Galois/Counter mode (AES 128 GCM) | null                                     | RFC 8446                   | [https://ciphersuite.info/rfc/8446/](https://ciphersuite.info/rfc/8446/) |